### 1) Registrierung des Testbenutzers
POST http://localhost:8080/api/v1/auth/register
Content-Type: application/json

{
  "username": "Test.Request.ActiveSubstanceController",
  "firstName": "Active",
  "lastName": "Tester",
  "birthDate": "1990-01-01",
  "password": "testActiveSubstance123"
}

> {%
    // Falls Benutzer bereits existiert: weiterhin versuchen einzuloggen
    client.log("Registrierungs-Antwort: " + response.status);
%}

### 2) Login und JWT extrahieren
POST http://localhost:8080/api/v1/auth/login
Content-Type: application/json

{
  "username": "Test.Request.ActiveSubstanceController",
  "password": "testActiveSubstance123"
}

> {%
    if (response.status === 200 && response.body && response.body.token) {
        client.global.set("active_jwt_token", response.body.token);
        client.log("JWT Token extrahiert: " + response.body.token.substring(0,20) + "...");
    } else {
        client.log("Login fehlgeschlagen: " + (response.body && response.body.message ? response.body.message : response.status));
    }
%}

### 3) Alle Wirkstoffe abrufen
GET http://localhost:8080/api/v1/active-substances
Authorization: Bearer {{active_jwt_token}}

### 4) Neuen Wirkstoff erstellen
POST http://localhost:8080/api/v1/active-substances
Content-Type: application/json
Authorization: Bearer {{active_jwt_token}}

{
  "name": "TestActiveSubstance",
  "synonyms": ["TAS", "TestSub"]
}

> {%
    if (response.status === 201 && response.body && response.body.id) {
        client.global.set("active_substance_id", response.body.id);
        client.log("Erstellter Wirkstoff ID: " + response.body.id);
    } else {
        client.log("Erstellen fehlgeschlagen: " + response.status + " body=" + JSON.stringify(response.body));
    }
%}

### 5) Wirkstoff nach ID abrufen
GET http://localhost:8080/api/v1/active-substances/{{active_substance_id}}
Authorization: Bearer {{active_jwt_token}}

### 6) Wirkstoff aktualisieren (PATCH)
PATCH http://localhost:8080/api/v1/active-substances/{{active_substance_id}}
Content-Type: application/json
Authorization: Bearer {{active_jwt_token}}

{
  "name": "TestActiveSubstance_Updated",
  "synonyms": ["TASU"]
}

### 7) Wirkstoff löschen
DELETE http://localhost:8080/api/v1/active-substances/{{active_substance_id}}
Authorization: Bearer {{active_jwt_token}}

> {%
    client.log("Delete ActiveSubstance Response: " + response.status);
%}

### 8) Testbenutzer löschen (Cleanup)
DELETE http://localhost:8080/api/v1/auth
Authorization: Bearer {{active_jwt_token}}